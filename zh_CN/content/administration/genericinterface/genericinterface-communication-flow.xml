<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

    <section id="genericinterface_communication_flow">
        <title>通用接口通讯流程</title>
        <para>
            通用接口有定义的流程来执行作为提供者和请求者的操作。
        </para>
        <para>
            这些流程描述如下：
        </para>

        <section>
            <title>OTRS作为提供者</title>
            <section>
                <title>
                    远程请求：
                </title>
                <orderedlist>
                    <listitem>
                        <para>
                            HTTP请求
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    OTRS接收到HTTP请求并传递它。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    提供者模块负责执行和控制这些操作。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            网络传输
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    网络传输模块解码数据有效载荷并从剩余数据中分离操作的名称。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    操作名称和操作数据都返回给提供者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <remark>外部数据</remark>
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    从远程系统发来的数据（这不是一个基于模块的层）。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            映射
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    按这个操作指定的映射配置（进入的请求数据映射）将数据从外部系统格式转化为OTRS内部格式。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    已转化的数据返回给提供者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <remark>内部数据</remark>
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    数据已经转化并准备传递到操作（这不是一个基于模块的层）。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            操作
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    接收并验证数据。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    执行用户访问控制。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    执行操作。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                </orderedlist>
            </section>
            <section>
                <title>
                    OTRS响应：
                </title>
                <orderedlist>
                        <listitem>
                            <para>
                                操作
                            </para>
                            <itemizedlist>
                                <listitem>
                                    <para>
                                        返回结果数据到提供者。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                    <listitem>
                        <para>
                            <remark>内部数据</remark>
                        </para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    数据从操作返回。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            映射
                        </para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    数据按映射配置中指定的映射（出站响应数据的映射）转化回远程系统的格式。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    已转化的数据返回给提供者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <remark>外部数据</remark>
                        </para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    转化的数据准备传递给网络传输作为响应。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            网络传输
                        </para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    接收远程系统格式的数据。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    为这个网络传输类型构建一个有效的响应。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            HTTP响应
                        </para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    响应发送回WEB服务客户端。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    如果出现一个错误（例如SOAP错误、HTTP错误等等），发送一个错误响应给远程系统。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                </orderedlist>
            </section>
        </section>

        <section>
            <title>OTRS作为请求者</title>
                <section>
                    <title>OTRS请求：</title>
                    <orderedlist>
                        <listitem>
                            <para>
                                事件触发器处理程序
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        基于WEB服务配置确定请求是同步还是异步。
                                    </para>
                                    <itemizedlist mark="round">
                                        <listitem>
                                            <para>
                                                同步
                                            </para>
                                            <itemizedlist mark="round">
                                                <listitem>
                                                    <para>
                                                        直接调用请求者以便创建一个新的请求，并通过这个层传递。
                                                    </para>
                                                </listitem>
                                            </itemizedlist>
                                        </listitem>
                                        <listitem>
                                            <para>
                                                异步
                                            </para>
                                            <itemizedlist mark="round">
                                                <listitem>
                                                    <para>
                                                        为OTRS守护进程创建一个新的通用接口（请求者）任务，通过委派该请求执行到计划程序进程，大大改善了用户体验。否则准备该请求和远程执行需要的所有时间都会加到触发这些请求的OTRS事件上。
                                                    </para>
                                                </listitem>
                                                <listitem>
                                                    <para>
                                                        在下一个循环中OTRS守护进程读取新任务并创建一个到请求者的调用，请求者会创建一个新的请求并通过这个层传递它。
                                                    </para>
                                                </listitem>
                                            </itemizedlist>
                                        </listitem>
                                    </itemizedlist>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                调用程序
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        接收来自事件的数据。
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        验证收到的数据（如果需要）。
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        调用核心模块来补足数据（如果需要）。
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        返回请求数据结构，或发送一个中止通讯信号给请求者以取消这个请求。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                <remark>内部数据</remark>
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        自请求者传来的数据（这不是一个基于模块的层）。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                映射
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        按映射配置（出站响应数据的映射）指定的格式将数据转化为远程系统的格式。
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        已经转化的数据返回给请求者。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                <remark>外部数据</remark>
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        转化后的数据准备发送给远程系统。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                网络传输
                            </para>
                                <itemizedlist mark="round">
                                    <listitem>
                                        <para>
                                            从请求者接收远程操作名称和已经转化为远程系统格式的数据。
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            为网络传输构建一个有效的请求。
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            将请求发送给远程系统并等待响应。
                                        </para>
                                    </listitem>
                                </itemizedlist>
                        </listitem>
                    </orderedlist>
                </section>
                <section>
                    <title>远程响应：</title>
                    <orderedlist>
                        <listitem>
                            <para>
                                网络传输
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        接收响应并解码数据的有效载荷。
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        将数据返回给请求者。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>
                                <remark>外部数据</remark>
                            </para>
                            <itemizedlist mark="round">
                                <listitem>
                                    <para>
                                        从远程系统收到的数据。
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                    <listitem>
                        <para>
                            映射
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    数据已用这个操作的映射配置指定的映射（进入的响应数据映射）从外部系统格式转化为OTRS内部格式。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    已经转化的数据返回给请求者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <remark>内部数据</remark>
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    已经转化的数据返回给请求者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            调用程序
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    接收返回的数据。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    根据每个调用程序的特殊需要处理数据（包括可能有的错误处理）。
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    返回调用程序结果和数据到请求者。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            事件处理程序或OTRS守护进程
                        </para>
                        <itemizedlist mark="round">
                            <listitem>
                                <para>
                                    接收来自请求的数据。在使用OTRS守护进程的情况下，将来在数据中可能还包含了创建一个任务的信息。
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                </orderedlist>
            </section>
        </section>
    </section>
